import{r as l,s as B,z as h,a as w,e as L,f as v,A as a,b as e,E as M,h as u,M as R,y as C,D as z,o as F,B as E,c as x,F as P,q as j,i as q,x as G,O as D,G as N,g as O,P as S}from"./index.4bfca30a.js";const A={class:"mb-3"},K=e("label",{for:"name",class:"form-label"},"\u540D\u7A31",-1),T={class:"mb-3"},H=e("label",{for:"abbr",class:"form-label"},"\u82F1\u6587\u540D\u7A31",-1),I=["disabled"],J={__name:"CreateUserGroupModal",props:{tempUserGroup:{type:Object,default(){return{}}}},emits:["createUserGroupMethod"],setup(V,{expose:U,emit:p}){const y=V,{apiPostUserGroups:g}=C,n=l(),t=l({}),c=l(null);B(()=>y.tempUserGroup.name,()=>{t.value=y.tempUserGroup});const k=async()=>{try{const i={name:t.value.name,keyword:t.value.keyword,enable:!0};await g(i),p("createUserGroupMethod",{target:"import",type:"\u6210\u529F"}),n.value.resetForm()}catch(i){p("createUserGroupMethod",{target:"import",type:"\u5931\u6557",error:`${i.response.data.statusCode}:${i.response.data.message}`})}};return U({createUserGroupModalRef:c,refs:n}),(i,m)=>{const f=h("Field"),r=h("ErrorMessage"),o=h("VForm");return w(),L(o,{ref_key:"refs",ref:n,onSubmit:k},{default:v(({errors:_,meta:b})=>[a(R,{ref_key:"createUserGroupModalRef",ref:c,"has-footer":!0,title:"\u65B0\u589E\u4F7F\u7528\u8005\u7FA4\u7D44","class-list":""},{body:v(()=>[e("div",A,[K,a(f,{id:"name",modelValue:t.value.name,"onUpdate:modelValue":m[0]||(m[0]=d=>t.value.name=d),name:"name",label:"\u540D\u7A31",type:"text",class:M(["form-control",{"is-invalid":_.name}]),rules:"required"},null,8,["modelValue","class"]),a(r,{name:"name",class:"invalid-feedback"})]),e("div",T,[H,a(f,{id:"abbr",modelValue:t.value.keyword,"onUpdate:modelValue":m[1]||(m[1]=d=>t.value.keyword=d),name:"keyword",label:"\u82F1\u6587\u540D\u7A31",type:"text",class:M(["form-control",{"is-invalid":_.keyword}]),rules:{required:!0,regex:/^[a-z0-9_-]{1,50}$/}},null,8,["modelValue","class"]),a(r,{name:"keyword",class:"invalid-feedback"})])]),footer:v(()=>[e("button",{type:"submit",disabled:!b.valid,class:"btn btn-primary"}," \u5EFA\u7ACB "+u(!b.valid)+" "+u(t.value.name)+" "+u(t.value.keyword),9,I)]),_:2},1536)]),_:1},512)}}},Q={class:"about px-4 mt-4 position-relative"},W=e("h1",{class:"fs-4 mb-0"},"\u4F7F\u7528\u8005\u7FA4\u7D44",-1),X={class:"card shadow-sm rounded-4 overflow-hidden mb-4"},Y={class:"card-header bg-white"},Z={class:"d-flex justify-content-between align-items-center"},ee=e("h2",{class:"h6 mb-0"},"\u4F7F\u7528\u8005\u7FA4\u7D44",-1),se={class:"input-group align-items-center"},te=e("div",{class:"bg-white border-0"},[e("span",{class:"material-icons fs-6 align-middle"}," search ")],-1),oe={class:"card-body p-0"},ae={class:"table-responsive"},re={class:"table table-hover mb-0 text-nowrap",style:{"font-size":"14px"}},le=e("thead",{class:"bg-light"},[e("tr",null,[e("th",{scope:"col",class:"ps-4 py-3 text-muted border-0"}," \u540D\u7A31 "),e("th",{scope:"col",class:"py-3 text-muted border-0"},"\u82F1\u6587\u540D\u7A31"),e("th",{scope:"col",class:"py-3 text-muted border-0"},"\u4F86\u6E90"),e("th",{scope:"col",class:"py-3 text-muted pe-3 border-0"}," \u5EFA\u7ACB\u6642\u9593 "),e("th",{scope:"col",class:"py-3 text-muted border-0"},"\u7DE8\u8F2F")])],-1),ne={class:"text-nowrap"},de=["id"],ce={scope:"row",class:"ps-4"},ie={class:"fs-6 mb-0"},ue=e("span",{class:"material-icons align-middle fs-6"}," edit ",-1),pe={class:"card-footer bg-white py-3"},me={class:"d-flex flex-wrap align-items-start"},be={__name:"UserGroupList",setup(V){const{apiGetUserGroups:U}=C,p=l(""),y=z.useLoading(),g=l([]),n=l({total:0,current_page:1}),t=l(""),c=async({keyword:r,page:o,count:_}={})=>{const b=y.show();try{const{groups:d,pagination:s}=await U({keyword:r,page:o,count:_});g.value=d,n.value=s}catch{G("danger","\u53D6\u5F97\u4F7F\u7528\u8005\u7FA4\u7D44\u5217\u8868\u5931\u6557","\u53D6\u5F97\u4F7F\u7528\u8005\u7FA4\u7D44\u5217\u8868\u5931\u6557")}finally{b.hide()}};F(()=>{c()});const k=l({}),i=()=>{p.value.show()},m=r=>{r.type==="\u6210\u529F"?G("success","\u5EFA\u7ACB\u4F7F\u7528\u8005\u7FA4\u7D44\u6210\u529F","\u5DF2\u6210\u529F\u5EFA\u7ACB\u4F7F\u7528\u8005\u7FA4\u7D44"):r.type==="\u5931\u6557"&&G("danger","\u5EFA\u7ACB\u4F7F\u7528\u8005\u7FA4\u7D44\u5931\u6557",r.error),p.value.hide(),c()},f=l(null);return F(()=>{p.value=new E(f.value.createUserGroupModalRef.hModal)}),(r,o)=>{const _=h("Field"),b=h("VForm"),d=h("router-link");return w(),x("div",null,[e("div",Q,[e("header",{class:"d-flex align-items-center justify-content-between border-bottom border-light pb-2 mb-4"},[W,e("button",{id:"addUserGroup",type:"button",class:"btn btn-primary",onClick:i},"\u65B0\u589E\u4F7F\u7528\u8005\u7FA4\u7D44")]),e("div",X,[e("div",Y,[e("div",Z,[ee,a(b,null,{default:v(({errors:s})=>[e("div",se,[te,a(_,{id:"dataTableSearch",name:"search",label:"\u641C\u5C0B",modelValue:t.value,"onUpdate:modelValue":o[0]||(o[0]=$=>t.value=$),type:"search",class:M(["form-control border-top-0 border-start-0 border-end-0 rounded-0",{"is-invalid":s.search}]),placeholder:"\u641C\u5C0B\u540D\u7A31\u3001\u82F1\u6587\u540D\u7A31",onKeydown:o[1]||(o[1]=D(N($=>c({keyword:t.value}),["prevent"]),["enter"]))},null,8,["modelValue","class"])])]),_:1})])]),e("div",oe,[e("div",ae,[e("table",re,[le,e("tbody",ne,[(w(!0),x(P,null,j(g.value,s=>(w(),x("tr",{key:s.id,id:`user-group-item${s.id}`,class:"align-middle"},[e("td",ce,[e("h5",ie,u(s.name),1)]),e("td",null,u(s.keyword),1),e("td",null,u(s.from),1),e("td",null,u(s.created_at.substr(0,9)),1),e("td",null,[a(d,{to:`/admin/users/groups/${s.id}`,class:"btn btn-sm btn-outline-gray"},{default:v(()=>[ue,O(" \u7DE8\u8F2F ")]),_:2},1032,["to"])])],8,de))),128))])])])]),e("div",pe,[e("div",me,[a(q(S),{modelValue:n.value.current_page,"onUpdate:modelValue":o[2]||(o[2]=s=>n.value.current_page=s),records:n.value.total,"per-page":20,options:{chunk:6},onPaginate:o[3]||(o[3]=s=>c({page:s}))},null,8,["modelValue","records"])])])])]),a(J,{ref_key:"createUserGroupModalComponentRef",ref:f,"temp-user-group":k.value,onCreateUserGroupMethod:m},null,8,["temp-user-group"])])}}};export{be as default};
